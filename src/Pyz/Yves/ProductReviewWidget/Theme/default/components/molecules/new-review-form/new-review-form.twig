{% extends model('component') %}

{% define config = {
    name: 'new-review-form',
    tag: 'div'
} %}

{% define data = {
    form: required
} %}

{% block body %}
    {% embed molecule('form') with {
        data: {
            form: data.form,
            options: {
                action: '#review'
            },
            layout: {
                'summary': 'col col--sm-12 review-summary',
                'description': 'col col--sm-12 review-description',
                'nickname': 'col col--sm-12 review-nickname'
            },
            submit: {
                enable: true,
                class: 'button button--black button--send-review'
            }
        },
        embed: {
            title: 'product_review.submit.add_a_review' | trans,
        }
    } only %}
        {% block title %}
            <div class="popup__top">
                {% if embed.title is not empty %}
                    <h5 class="popup__title">{{ embed.title }}</h5>
                {% endif %}
                {% include atom('icon') with {
                    class: 'popup__close js-review__new-review-trigger',
                    data: {
                        name: 'close'
                    }
                } only %}
            </div>
        {% endblock %}

        {% block field %}
            {% if fieldName == 'rating' %}
                <div class="form__field col col--sm-12 review-rating">
                    {% do field.setRendered %}

                    <label>
                        {{form_label(field)}}
                        {% include molecule('rating-selector', 'ProductReviewWidget') with {
                            modifiers: ['expand'],
                            data: {
                                maxValue: (field.vars.choices | length) - 1,
                                inputId: 'productReviewForm_rating',
                                inputName: 'productReviewForm[rating]'
                            }
                        } only %}
                        {{form_errors(field)}}
                    </label>
                </div>
            {% else %}
                {{parent()}}
            {% endif %}
        {% endblock %}
    {% endembed %}
{% endblock %}
